<!doctype html>

<html>

<head>

    <meta charset="utf-8">
    <script src="Script/settings.js"></script>
    <script src="Script/ball.js"></script>
    <script src="Script/bar.js"></script>
    <script src="Script/canvas.js"></script>
    <script src="Script/score.js"></script>
    <script src="Script/block.js"></script>
    <script src="Script/board.js"></script>
    <script src="Script/game.js"></script>

    <link rel="stylesheet" type="text/css" href="Style/Style.css" />

    <script type="text/javascript">
        /*
        Dont have them global
        Add suppoert fort any resolution
        Add pause
        Add hightscore (online)
        Restart when you die
        Use a game-engin for faster loop
        Use sprites for bal, paddle and blocks
        Do all drawing in own loop, and not in enteie move
        */

        var ball;
        var bar;
        var board;
        var score;
        var gameLoopId;
        var DEMO_MODE = false;
		var paint;
        var startGame = function () {
            document.getElementById('startButton').style.visibility = 'hidden';
            var canvasDom = document.getElementById('GameCanvas');
            canvasDom.style.visibility = "visible";
            canvasDom.style.cursor = "none";
            canvasDom.width = (window.innerWidth - 50);
            canvasDom.height = (window.innerHeight - 50);
            // It will not work on other resolutions now.. so I will remake it to work on any
            canvasDom.width = 800;
            canvasDom.height = 600;


            var context = canvasDom.getContext('2d');
            var canvas = new CanvasObj(context, canvasDom);
            paint = new Paint(canvas);

            run();
        };

      	var run = function () {
			ball = new BallObj();
		    bar = new BarObj();
            board = new BoardObj();
			
        	score = new ScoreObj();

			// draw once, but not in gameloop
	      	paint.drawBlocks(board.blocks);
			
		    window.addEventListener('keydown', onKey, true);
			
            var canvasDom = document.getElementById('GameCanvas');
			
			canvasDom.addEventListener('mousemove', function (e){ 
				bar.X = e.clientX; 
				paint.drawBar(bar);	
			}, true);

			//Bruker: ball, score, board
            gameLoopId = setInterval(gameLoop, 4);
			
        };

        var onKey = function (evt) {
            switch (evt.keyCode) {
                case 80:  // p was pressed (112)
                    if (gameLoopId == null) {
                        pauseGame();
                        break;
                    } else {
                        resumeGame();
                        break;
                    }
            }
        };

        var pauseGame = function () {
            gameLoopId = setInterval(gameLoop, 0);
        };

        var resumeGame = function () {
            clearInterval(gameLoopId);
            gameLoopId = null;
        };

    </script>

    <title>Demo</title>



</head>

<body>

    <input type="button" value="Start" id="startButton" class="button" onclick="startGame()" />


	<div id="www">xxx</div>
    <canvas id="GameCanvas" style="visibility: hidden">This text is displayed if your browser does not support HTML5 Canvas.</canvas>



</body>

</html>

